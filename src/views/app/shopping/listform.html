

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>信息修改</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" href="../../../layuiadmin/layui/css/layui.css" media="all">
  <link rel="stylesheet" href="../../../layuiadmin/style/admin.css" media="all">
</head>
<body>

  <div class="layui-form" lay-filter="layuiadmin-form-list" id="layuiadmin-form-list" style="padding: 20px 30px 0 0;">
    <div class="layui-form-item" id="shoping_item_id">
      <label class="layui-form-label">商品索引号</label>
      <div class="layui-input-block">
        <input type="text" name="id" id="shoping_id" lay-verify="required" autocomplete="off" class="layui-input">
      </div>
    </div>    
    <div class="layui-form-item">
      <label class="layui-form-label">商品名称</label>
      <div class="layui-input-block">
        <input type="text" name="name" id="shoping_name" lay-verify="required" placeholder="请输入要修改的商品名称" autocomplete="off" class="layui-input">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">价格</label>
      <div class="layui-input-block">
        <input type="text" name="price" id="shoping_price" lay-verify="required" placeholder="请输入要修改的价格" autocomplete="off" class="layui-input">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">提成</label>
      <div class="layui-input-block">
        <input type="text" name="royalty" id="shoping_royalty" lay-verify="required" placeholder="请输入要修改的提成" autocomplete="off" class="layui-input">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">库存</label>
      <div class="layui-input-block">
        <input type="text" name="stock" id="shoping_stock" lay-verify="required" placeholder="请输入要修改的库存" autocomplete="off" class="layui-input">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">积分</label>
      <div class="layui-input-block">
        <input type="text" name="integral" id="shoping_integral" lay-verify="required" placeholder="请输入要修改的提成" autocomplete="off" class="layui-input">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">本周推荐</label>
      <div class="layui-input-block">
        <input type="checkbox" lay-filter="switch" lay-verify="required" name="one_switch" id="one_switch" lay-skin="switch" lay-text="ON|OFF">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">热销好物</label>
      <div class="layui-input-block">
        <input type="checkbox" lay-filter="switch" lay-verify="required" name="good_switch" id="good_switch" lay-skin="switch" lay-text="ON|OFF">
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label">轮播广告</label>
      <div class="layui-input-block">
        <input type="checkbox" lay-filter="switch" lay-verify="required" name="post_switch" id="post_switch" lay-skin="switch" lay-text="ON|OFF">
      </div>
    </div>
<!--     <div class="layui-form-item">
      <label class="layui-form-label">分享购</label>
      <div class="layui-input-block">
        <input type="checkbox" lay-filter="switch" lay-verify="required" name="share_switch" id="share_switch" lay-skin="switch" lay-text="ON|OFF">
      </div>
    </div> -->
    <div class="layui-form-item">
      <label class="layui-form-label">商品类型</label>
      <div class="layui-input-block">
        <select name="shopping_type" id="shopping_type" lay-filter="aihao">
          <option value="7">限时抢</option>
          <option value="8">1元购</option>
          <option value="9">新品特价</option>
          <option value="10">教育教学</option>
          <option value="11">教育周边</option>
          <option value="12">绿色农场</option>
          <option value="13">健康养生</option>
          <option value="14">公告中心</option>
        </select>
      </div>
    </div>

    <div class="layui-form-item layui-hide">
      <input type="button" lay-submit lay-filter="LAY-app-forum-submit" id="LAY-app-forum-submit" value="确认">
    </div>

  <div class="layui-fluid">
    <div class="layui-row layui-col-space15">
      <div class="layui-col-md12">
        <div class="layui-card">
          <div class="layui-card-header">标题图片重传</div>
          <div class="layui-card-body">
            <div class="layui-upload">
              <button type="button" class="layui-btn layui-btn-normal" id="test-upload-change">选择图片</button>
              <button type="button" class="layui-btn" id="test-upload-change-action">开始上传</button>
            </div>
          </div>
        </div>
      </div>


      
      <div class="layui-col-md12">
        <div class="layui-card">
          <div class="layui-card-header">轮播图片重传(支持多张图片)</div>
          <div class="layui-card-body">
            <div class="layui-upload">
              <button type="button" class="layui-btn layui-btn-normal" id="test-upload-testList">选择图片</button> 
              <div class="layui-upload-list">
                <table class="layui-table">
                  <thead>
                    <tr><th>图片名</th>
                    <th>大小</th>
                    <th>状态</th>
                    <th>操作</th>
                  </tr></thead>
                  <tbody id="test-upload-demoList"></tbody>
                </table>
              </div>
              <button type="button" class="layui-btn" id="test-upload-testListAction">开始上传</button>
            </div> 
          </div>
        </div>
      </div>

      <div class="layui-col-md12">
        <div class="layui-card">
          <div class="layui-card-header">详情图片重传(支持多张图片)</div>
          <div class="layui-card-body">
            <div class="layui-upload">
              <button type="button" class="layui-btn layui-btn-normal" id="test-upload-testList1">选择图片</button> 
              <div class="layui-upload-list">
                <table class="layui-table">
                  <thead>
                    <tr><th>图片名</th>
                    <th>大小</th>
                    <th>状态</th>
                    <th>操作</th>
                  </tr></thead>
                  <tbody id="test-upload-demoList1"></tbody>
                </table>
              </div>
              <button type="button" class="layui-btn" id="test-upload-testListAction1">开始上传</button>
            </div> 
          </div>
        </div>
      </div>

      <div class="layui-col-md12">
        <div class="layui-card">
          <div class="layui-card-header">海报图片重传</div>
          <div class="layui-card-body">
            <div class="layui-upload">
              <button type="button" class="layui-btn layui-btn-normal" id="test-upload-testList2">选择图片</button> 
              <div class="layui-upload-list">
                <table class="layui-table">
                  <thead>
                    <tr><th>图片名</th>
                    <th>大小</th>
                    <th>状态</th>
                    <th>操作</th>
                  </tr></thead>
                  <tbody id="test-upload-demoList2"></tbody>
                </table>
              </div>
              <button type="button" class="layui-btn" id="test-upload-testListAction2">开始上传</button>
            </div> 
          </div>
        </div>
      </div>
      
    </div>
  </div>

  </div>

  <script src="../../../layuiadmin/layui/layui.js"></script>  
  <script>

  layui.config({
    base: '../../../layuiadmin/' //静态资源所在路径
  }).extend({
    index: 'lib/index' //主入口模块
  }).use(['index', 'form', 'upload'], function(){
    var $ = layui.$
    ,form = layui.form
    ,upload = layui.upload
    ,Id = $("#shoping_id").val()
    ,File_Type = $("#shopping_type").val();

    form.on('select(aihao)', function (data) {
      File_Type = data.value
      $.ajax({
        type:'POST',
        url:'https://www.hattonstar.com/updateShoppingType',
        dataType:'json',
        data:{
          id:Id,
          type:File_Type
        },
        success:function(data){
          console.log("success");
        },
        error:function(hex){
          console.log("failure");
        }
      }) 
    });

    upload.render({
    elem: '#test-upload-change'
    ,url: 'https://www.hattonstar.com/editOne'
    ,size:1024
    ,data:{
      'path': 'title',
      'id':Id
    }
    ,auto: false
    ,bindAction: '#test-upload-change-action'
    ,done: function(res){
      if (res.code == 0) {
        return layer.msg('标题图片替换成功');
      }
    }
  });


  //多文件列表示例
  var demoListView = $('#test-upload-demoList')
  ,uploadListIns = upload.render({
    elem: '#test-upload-testList'
    ,url: 'https://www.hattonstar.com/uploadOneEx'
    ,size:1024
    ,data:{
      'path': 'lunbo',
      'id':Id
    }
    ,accept: 'images'
    ,multiple: true
    ,auto: false
    ,bindAction: '#test-upload-testListAction'
    ,choose: function(obj){
      //先清除文件
     $.ajax({
        type:'POST',
        url:'https://www.hattonstar.com/deleteAll',
        dataType:'json',
        data:{
          id:Id,
          path:'lunbo'
        },
        success:function(data){
        },
        error:function(hex){
        }
      }) 
      var files = this.files = obj.pushFile(); //将每次选择的文件追加到文件队列
      //读取本地文件
      obj.preview(function(index, file, result){
        var tr = $(['<tr id="upload-'+ index +'">'
          ,'<td>'+ file.name +'</td>'
          ,'<td>'+ (file.size/1014).toFixed(1) +'kb</td>'
          ,'<td>等待上传</td>'
          ,'<td>'
            ,'<button class="layui-btn layui-btn-mini test-upload-demo-reload layui-hide">重传</button>'
            ,'<button class="layui-btn layui-btn-mini layui-btn-danger test-upload-demo-delete">删除</button>'
          ,'</td>'
        ,'</tr>'].join(''));
        
        //单个重传
        tr.find('.test-upload-demo-reload').on('click', function(){
          obj.upload(index, file);
        });
        
        //删除
        tr.find('.test-upload-demo-delete').on('click', function(){
          delete files[index]; //删除对应的文件
          tr.remove();
          uploadListIns.config.elem.next()[0].value = ''; //清空 input file 值，以免删除后出现同名文件不可选
        });
        
        demoListView.append(tr);
      });
    }
    ,done: function(res, index, upload){
      if(res.code == 0){ //上传成功
        var tr = demoListView.find('tr#upload-'+ index)
        ,tds = tr.children();
        tds.eq(2).html('<span style="color: #5FB878;">上传成功</span>');
        tds.eq(3).html(''); //清空操作
        return delete this.files[index]; //删除文件队列已经上传成功的文件
      }
      this.error(index, upload);
    }
    ,error: function(index, upload){
      var tr = demoListView.find('tr#upload-'+ index)
      ,tds = tr.children();
      tds.eq(2).html('<span style="color: #FF5722;">上传失败</span>');
      tds.eq(3).find('.test-upload-demo-reload').removeClass('layui-hide'); //显示重传
    }
  });


  var demoListView1 = $('#test-upload-demoList1')
  ,uploadListIns1 = upload.render({
    elem: '#test-upload-testList1'
    ,url: 'https://www.hattonstar.com/uploadOneEx'
    ,size:1024
    ,data:{
      'path': 'detail',
      'id':Id
    }
    ,accept: 'images'
    ,multiple: true
    ,auto: false
    ,bindAction: '#test-upload-testListAction1'
    ,choose: function(obj){   
      var files = this.files = obj.pushFile(); //将每次选择的文件追加到文件队列
      //先清除文件
     $.ajax({
        type:'POST',
        url:'https://www.hattonstar.com/deleteAll',
        dataType:'json',
        data:{
          id:Id,
          path:'detail'
        },
        success:function(data){
        },
        error:function(hex){
        }
      }) 
      //读取本地文件
      obj.preview(function(index, file, result){
        var tr = $(['<tr id="upload-'+ index +'">'
          ,'<td>'+ file.name +'</td>'
          ,'<td>'+ (file.size/1014).toFixed(1) +'kb</td>'
          ,'<td>等待上传</td>'
          ,'<td>'
            ,'<button class="layui-btn layui-btn-mini test-upload-demo-reload layui-hide">重传</button>'
            ,'<button class="layui-btn layui-btn-mini layui-btn-danger test-upload-demo-delete">删除</button>'
          ,'</td>'
        ,'</tr>'].join(''));
        
        //单个重传
        tr.find('.test-upload-demo-reload').on('click', function(){
          obj.upload(index, file);
        });
        
        //删除
        tr.find('.test-upload-demo-delete').on('click', function(){
          delete files[index]; //删除对应的文件
          tr.remove();
          uploadListIns1.config.elem.next()[0].value = ''; //清空 input file 值，以免删除后出现同名文件不可选
        });
        
        demoListView1.append(tr);
      });
    }
    ,done: function(res, index, upload){
      if(res.code == 0){ //上传成功
        var tr = demoListView1.find('tr#upload-'+ index)
        ,tds = tr.children();
        tds.eq(2).html('<span style="color: #5FB878;">上传成功</span>');
        tds.eq(3).html(''); //清空操作
        return delete this.files[index]; //删除文件队列已经上传成功的文件
      }
      this.error(index, upload);
    }
    ,error: function(index, upload){
      var tr = demoListView1.find('tr#upload-'+ index)
      ,tds = tr.children();
      tds.eq(2).html('<span style="color: #FF5722;">上传失败</span>');
      tds.eq(3).find('.test-upload-demo-reload').removeClass('layui-hide'); //显示重传
    }
  });

  var demoListView2 = $('#test-upload-demoList2')
  ,uploadListIns2 = upload.render({
    elem: '#test-upload-testList2'
    ,url: 'https://www.hattonstar.com/uploadOneEx'
    ,size:1024
    ,data:{
      'path': 'poster',
      'id':Id
    }
    ,accept: 'images'
    ,multiple: false
    ,auto: false
    ,bindAction: '#test-upload-testListAction2'
    ,choose: function(obj){   
      var files = this.files = obj.pushFile(); //将每次选择的文件追加到文件队列
      //先清除文件
     $.ajax({
        type:'POST',
        url:'https://www.hattonstar.com/deleteAll',
        dataType:'json',
        data:{
          id:Id,
          path:'poster'
        },
        success:function(data){
        },
        error:function(hex){
        }
      })
      //读取本地文件
      obj.preview(function(index, file, result){
        var tr = $(['<tr id="upload-'+ index +'">'
          ,'<td>'+ file.name +'</td>'
          ,'<td>'+ (file.size/1014).toFixed(1) +'kb</td>'
          ,'<td>等待上传</td>'
          ,'<td>'
            ,'<button class="layui-btn layui-btn-mini test-upload-demo-reload layui-hide">重传</button>'
            ,'<button class="layui-btn layui-btn-mini layui-btn-danger test-upload-demo-delete">删除</button>'
          ,'</td>'
        ,'</tr>'].join(''));
        
        //单个重传
        tr.find('.test-upload-demo-reload').on('click', function(){
          obj.upload(index, file);
        });
        
        //删除
        tr.find('.test-upload-demo-delete').on('click', function(){
          delete files[index]; //删除对应的文件
          tr.remove();
          uploadListIns2.config.elem.next()[0].value = ''; //清空 input file 值，以免删除后出现同名文件不可选
        });
        
        demoListView2.append(tr);
      });
    }
    ,done: function(res, index, upload){
      if(res.code == 0){ //上传成功
        var tr = demoListView2.find('tr#upload-'+ index)
        ,tds = tr.children();
        tds.eq(2).html('<span style="color: #5FB878;">上传成功</span>');
        tds.eq(3).html(''); //清空操作
        return delete this.files[index]; //删除文件队列已经上传成功的文件
      }
      this.error(index, upload);
    }
    ,error: function(index, upload){
      var tr = demoListView2.find('tr#upload-'+ index)
      ,tds = tr.children();
      tds.eq(2).html('<span style="color: #FF5722;">上传失败</span>');
      tds.eq(3).find('.test-upload-demo-reload').removeClass('layui-hide'); //显示重传
    }
  });
           
  })
  </script>
</body>
</html>